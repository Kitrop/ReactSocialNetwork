{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/artem/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _toConsumableArray from\"C:/Users/artem/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"C:/Users/artem/my-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\artem\\\\my-app\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";// actions\nimport{userApi}from'../../compo/api/api';// name action\nvar FOLLOW_USER='follow/FOLLOW_USER';var UNFOLLOW_USER='unfollow/UNFOLLOW_USER';var SET_USERS='setUsers/SET_USERS';var SET_CURRENT_PAGE='setCurrentPage/SET_CURRENT_PAGE';var SET_TOTAL_USERS_COUNT='setTotalUsersCount/SET_TOTAL_USERS_COUNT';var SWITCH_IS_FETCHING='switchIsFetching/SWITCH_IS_FETCHING';var SWITCH_IS_FOLLOWING='switchIsFollowing/SWITCH_IS_FOLLOWING';// state\nvar initialState={users:[],pageSize:5,ifFetching:true,totalUsersCount:0,currentPage:1,isFollowing:[]};//\nvar updateObj=function updateObj(items,itemId,objName,newPropsObj){return items.map(function(u){if(u[objName]===itemId){return _objectSpread(_objectSpread({},u),newPropsObj);}return u;});};//reducer\nvar usersReducer=function usersReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case FOLLOW_USER:return _objectSpread(_objectSpread({},state),{},{users:updateObj(state.users,action.userId,'id',{followed:true})});case UNFOLLOW_USER:return _objectSpread(_objectSpread({},state),{},{users:updateObj(state.users,action.userId,'id',{followed:false})});case SET_USERS:{return _objectSpread(_objectSpread({},state),{},{users:_toConsumableArray(action.users)});}case SET_CURRENT_PAGE:{return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});}case SET_TOTAL_USERS_COUNT:{return _objectSpread(_objectSpread({},state),{},{totalUsersCount:action.totalUsersCount});}case SWITCH_IS_FETCHING:{return _objectSpread(_objectSpread({},state),{},{ifFetching:action.ifFetching});}case SWITCH_IS_FOLLOWING:{return _objectSpread(_objectSpread({},state),{},{isFollowing:action.ifFetching?[].concat(_toConsumableArray(state.isFollowing),[action.userId]):state.isFollowing.filter(function(id){return id!==action.userId;})});}default:return state;}};// actionCreator\nexport var follow=function follow(userId){return{type:FOLLOW_USER,userId:userId};};export var unfollow=function unfollow(userId){return{type:UNFOLLOW_USER,userId:userId};};export var setUsers=function setUsers(users){return{type:SET_USERS,users:users};};export var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var setTotalUsersCount=function setTotalUsersCount(totalUsersCount){return{type:SET_TOTAL_USERS_COUNT,totalUsersCount:totalUsersCount};};export var switchIsFetching=function switchIsFetching(ifFetching){return{type:SWITCH_IS_FETCHING,ifFetching:ifFetching};};export var switchIsFollowing=function switchIsFollowing(ifFetching,userId){return{type:SWITCH_IS_FOLLOWING,ifFetching:ifFetching,userId:userId};};// thunkCreator\nexport var getUserThunk=function getUserThunk(currentPage,pageSize){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var apiMethod,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:apiMethod=userApi.getUserApi.bind(userApi);dispatch(switchIsFetching(true));_context.next=4;return apiMethod(currentPage,pageSize);case 4:data=_context.sent;dispatch(switchIsFetching(false));dispatch(setUsers(data.items));dispatch(setTotalUsersCount(data.totalCount));case 8:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var unfollowThunk=function unfollowThunk(id){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return followUnfollowFlowThunk(dispatch,id,userApi.deleteUserApi.bind(userApi),unfollow);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var followThunk=function followThunk(id){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return followUnfollowFlowThunk(dispatch,id,userApi.postUserApi.bind(userApi),follow);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};var followUnfollowFlowThunk=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(dispatch,id,apiMethod,actionCreator){var data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:dispatch(switchIsFollowing(true,id));_context4.next=3;return apiMethod(id);case 3:data=_context4.sent;if(data.resultCode===0){dispatch(actionCreator(id));}dispatch(switchIsFollowing(false,id));case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function followUnfollowFlowThunk(_x4,_x5,_x6,_x7){return _ref4.apply(this,arguments);};}();export default usersReducer;","map":{"version":3,"sources":["C:/Users/artem/my-app/src/redux/reducers/usersReducer.js"],"names":["userApi","FOLLOW_USER","UNFOLLOW_USER","SET_USERS","SET_CURRENT_PAGE","SET_TOTAL_USERS_COUNT","SWITCH_IS_FETCHING","SWITCH_IS_FOLLOWING","initialState","users","pageSize","ifFetching","totalUsersCount","currentPage","isFollowing","updateObj","items","itemId","objName","newPropsObj","map","u","usersReducer","state","action","type","userId","followed","filter","id","follow","unfollow","setUsers","setCurrentPage","setTotalUsersCount","switchIsFetching","switchIsFollowing","getUserThunk","dispatch","apiMethod","getUserApi","bind","data","totalCount","unfollowThunk","followUnfollowFlowThunk","deleteUserApi","followThunk","postUserApi","actionCreator","resultCode"],"mappings":"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","sourcesContent":["// actions\r\nimport {userApi} from '../../compo/api/api'\r\n\r\n// name action\r\nconst FOLLOW_USER = 'follow/FOLLOW_USER'\r\nconst UNFOLLOW_USER = 'unfollow/UNFOLLOW_USER'\r\nconst SET_USERS = 'setUsers/SET_USERS'\r\nconst SET_CURRENT_PAGE = 'setCurrentPage/SET_CURRENT_PAGE'\r\nconst SET_TOTAL_USERS_COUNT = 'setTotalUsersCount/SET_TOTAL_USERS_COUNT'\r\nconst SWITCH_IS_FETCHING = 'switchIsFetching/SWITCH_IS_FETCHING'\r\nconst SWITCH_IS_FOLLOWING = 'switchIsFollowing/SWITCH_IS_FOLLOWING'\r\n\r\n// state\r\nlet initialState = {\r\n    users: [],\r\n    pageSize: 5,\r\n    ifFetching: true,\r\n    totalUsersCount: 0,\r\n    currentPage: 1,\r\n    isFollowing: []\r\n}\r\n\r\n//\r\nconst updateObj = (items, itemId, objName, newPropsObj) => {\r\n    return items.map(u => {\r\n        if (u[objName] === itemId) {\r\n            return {...u, ...newPropsObj}\r\n        }\r\n        return u\r\n    })\r\n}\r\n\r\n//reducer\r\nconst usersReducer = (state = initialState, action) => {\r\n    switch (action.type) {\r\n        case FOLLOW_USER:\r\n            return {\r\n                ...state,\r\n                users: updateObj(state.users, action.userId, 'id', {followed: true})\r\n            }\r\n        case UNFOLLOW_USER:\r\n            return {\r\n                ...state,\r\n                users: updateObj(state.users, action.userId, 'id', {followed: false})\r\n            }\r\n        case SET_USERS: {\r\n            return {...state, users: [...action.users]}\r\n        }\r\n        case SET_CURRENT_PAGE: {\r\n            return {...state, currentPage: action.currentPage}\r\n        }\r\n        case SET_TOTAL_USERS_COUNT: {\r\n            return {...state, totalUsersCount: action.totalUsersCount}\r\n        }\r\n        case SWITCH_IS_FETCHING: {\r\n            return {...state, ifFetching: action.ifFetching}\r\n        }\r\n        case SWITCH_IS_FOLLOWING: {\r\n            return {\r\n                ...state,\r\n                isFollowing: action.ifFetching\r\n                    ? [...state.isFollowing, action.userId]\r\n                    : state.isFollowing.filter(id => id !== action.userId)\r\n            }\r\n        }\r\n        default:\r\n            return state\r\n    }\r\n}\r\n\r\n// actionCreator\r\nexport const follow = (userId) => ({type: FOLLOW_USER, userId})\r\nexport const unfollow = (userId) => ({type: UNFOLLOW_USER, userId})\r\nexport const setUsers = (users) => ({type: SET_USERS, users})\r\nexport const setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\r\nexport const setTotalUsersCount = (totalUsersCount) => ({type: SET_TOTAL_USERS_COUNT, totalUsersCount})\r\nexport const switchIsFetching = (ifFetching) => ({type: SWITCH_IS_FETCHING, ifFetching})\r\nexport const switchIsFollowing = (ifFetching, userId) => ({type: SWITCH_IS_FOLLOWING, ifFetching, userId})\r\n\r\n// thunkCreator\r\nexport const getUserThunk = (currentPage, pageSize) => async (dispatch) => {\r\n    const apiMethod = userApi.getUserApi.bind(userApi)\r\n    dispatch(switchIsFetching(true))\r\n    let data = await apiMethod(currentPage, pageSize)\r\n    dispatch(switchIsFetching(false))\r\n    dispatch(setUsers(data.items))\r\n    dispatch(setTotalUsersCount(data.totalCount))\r\n}\r\nexport const unfollowThunk = (id) => async (dispatch) => {\r\n    await followUnfollowFlowThunk(dispatch, id, userApi.deleteUserApi.bind(userApi), unfollow)\r\n}\r\nexport const followThunk = (id) => async (dispatch) => {\r\n    await followUnfollowFlowThunk(dispatch, id, userApi.postUserApi.bind(userApi), follow)\r\n}\r\nconst followUnfollowFlowThunk = async (dispatch, id, apiMethod, actionCreator) => {\r\n    dispatch(switchIsFollowing(true, id))\r\n    let data = await apiMethod(id)\r\n    if (data.resultCode === 0) {\r\n        dispatch(actionCreator(id))\r\n    }\r\n    dispatch(switchIsFollowing(false, id))\r\n}\r\n\r\n\r\nexport default usersReducer"]},"metadata":{},"sourceType":"module"}